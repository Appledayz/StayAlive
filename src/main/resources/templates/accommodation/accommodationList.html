<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<title>숙소 리스트</title>
<!--다음 주소검색 API  -->
<script src="http://dmaps.daum.net/map_js_init/postcode.v2.js"></script>
<!--다음 지도 API  -->
<script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=48ed4ce03423252b26250f66a5ece330&libraries=services"></script>
<!-- jquery(3.3.1)  -->
<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<!-- bootstrap(4.1.3)  -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
</head>
<script th:inline="javascript">
//<![CDATA[ 
	$(function() {
		var map;
		$('#theModal').on('show.bs.modal', function (e) {
			$(".modal-body").empty();
			var button = $(e.relatedTarget);
		  	$.ajax({
		  		url : "detail",
		  		data : {"accommodationNo" : button.data("remote")},
		  		type: 'GET',
				contentType:"application/x-www-form-urlencoded",
				success: function(data){
					$(".modal-body").append("<div id='map' style='width:300px;height:300px;'></div>");
					
				    var mapContainer = document.getElementById('map'); // 지도를 표시할 div 
				    var mapOption = { 
				        center: new daum.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
				        level: 3 // 지도의 확대 레벨			 
					}
				    map = new daum.maps.Map(mapContainer, mapOption);
				    $(".modal-body").append(data.accommodationDetail);
         	    }
		  	});
		});
		$('#theModal').on('shown.bs.modal', function() {
			map.relayout();
		});
		    
		});
// ]]>
</script>

<body>
<div class="container">
	<table class="table table-stroped">
		<thead>
			<tr>
				<th>이름</th>
				<th>분류</th>
				<th>지역</th>
				<th>주소</th>
				<th>회원 ID</th>
				<th>상세</th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="item : ${list}">
				<td th:text="${item.accommodationName}"></td>
				<td th:text="${item.accommodationCategoryName}"></td>
				<td th:text="${item.addressSidoName + ' '+ item.addressSigunguName}"></td>
				<td th:text="${item.accommodationAddress}"></td>
				<td th:text="${item.memberId}"></td>
				<td><a class="btn btn-primary" data-toggle="modal" data-target="#theModal" th:attr="data-remote=${item.accommodationNo}">상세</a></td>
			</tr>
		</tbody>
	</table>
</div>

<!-- 모달  -->
<div class="modal fade" id="theModal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" >
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalLabel">My modal</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
               
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
</body>
</html>